<!-- Modal -->
<div
  class="modal fade"
  id="delayedModal"
  tabindex="-1"
  aria-labelledby="delayedModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog">
    <div class="modal-content border-0 rounded-4 shadow-lg">
      <!-- Modal Header with title and close -->
      <div class="modal-header border-0 pb-0">
        <h3 class="modal-title fw-bold" id="delayedModalLabel">
          Request a Call Back
        </h3>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <div class="modal-body p-3 pt-3">
        <form id="contactForm">
          <div
            id="responseMessage"
            class="text-success fw-semibold text-center mb-3"
          ></div>

          <div class="mb-3">
            <label for="name" class="form-label">Full Name *</label>
            <input
              type="text"
              class="form-control rounded-3"
              id="name"
              name="name"
              required
            />
          </div>

          <div class="mb-3">
            <label for="email" class="form-label">Email *</label>
            <input
              type="email"
              class="form-control rounded-3"
              id="email"
              name="email"
              required
            />
          </div>

          <div class="mb-3">
            <label for="phone" class="form-label"
              >Mobile (with country code) *</label
            >
            <input
              type="tel"
              class="form-control rounded-3"
              id="phone"
              name="phone"
              required
            />
          </div>

          <div class="mb-3">
            <label for="message" class="form-label">Message *</label>
            <textarea
              class="form-control rounded-3"
              id="message"
              name="message"
              rows="3"
              required
            ></textarea>
          </div>

          <!-- Hidden Inputs -->
          <input
            type="hidden"
            id="lead_source"
            name="lead_source"
            value="jenkins-alternative"
          />
          <input
            type="hidden"
            id="campaign_id"
            name="campaign_id"
            value="280"
          />

          <button type="submit" class="btn btn-primary w-100 rounded-3 py-2">
            Submit
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- JavaScript -->
<script>
  document
    .getElementById("contactForm")
    .addEventListener("submit", function (event) {
      event.preventDefault();

      const formData = {
        lead: {
          first_name: document.getElementById("name").value,
          email: document.getElementById("email").value,
          phone: document.getElementById("phone").value,
          linkedin_profile: document.getElementById("message").value,
          lead_source: document.getElementById("lead_source").value,
          campaign_id: document.getElementById("campaign_id").value,
        },
      };

      fetch("https://app.blinkcrm.in/api/leads", {
        method: "POST",
        mode: "cors",
        headers: {
          "Content-Type": "application/json; charset=utf-8",
          api_key: "19a5c89fb2ef43c1969d00e4554ab99e",
        },
        body: JSON.stringify(formData),
      })
        .then((response) => response.json())
        .then((data) => {
          const messageDiv = document.getElementById("responseMessage");
          messageDiv.textContent = "Thank you for your message!";
          document.getElementById("contactForm").reset();

          setTimeout(() => {
            const modal = bootstrap.Modal.getInstance(
              document.getElementById("delayedModal")
            );
            modal.hide();
            messageDiv.textContent = "";
          }, 2000);
        })
        .catch((error) => {
          document.getElementById("responseMessage").textContent =
            "Something went wrong. Please try again.";
          console.error("Error:", error);
        });
    });
</script>
